# æ•°å­¦è¿ç®—å·¥å…· - Cloudflare Worker MCP æœåŠ¡

[![Deploy to Cloudflare Workers](https://deploy.workers.cloudflare.com/button)](https://deploy.workers.cloudflare.com/?url=https://github.com/your-repo/math-mcp-cloudflare)

ä¸€ä¸ªåŸºäº **MCP (Model Context Protocol)** åè®®çš„æ•°å­¦è¿ç®—å·¥å…·ï¼Œä¸“ä¸ºå¤§æ¨¡å‹æä¾›å¼ºå¤§çš„æ•°å­¦è®¡ç®—èƒ½åŠ›ã€‚æœ¬é¡¹ç›®éƒ¨ç½²åœ¨ Cloudflare Worker ä¸Šï¼Œæä¾›é«˜æ€§èƒ½ã€ä½å»¶è¿Ÿçš„æ•°å­¦è¿ç®—æœåŠ¡ã€‚

## ğŸš€ é¡¹ç›®ç‰¹è‰²

- **ğŸ¤– AI å‹å¥½**: åŸºäº MCP åè®®ï¼Œä¸“ä¸ºå¤§æ¨¡å‹è®¾è®¡çš„æ•°å­¦è¿ç®—å·¥å…·
- **âš¡ é«˜æ€§èƒ½**: éƒ¨ç½²åœ¨ Cloudflare Worker è¾¹ç¼˜ç½‘ç»œï¼Œå…¨çƒä½å»¶è¿Ÿè®¿é—®
- **ğŸ”§ åŠŸèƒ½ä¸°å¯Œ**: æ”¯æŒåŸºç¡€è¿ç®—ã€çŸ©é˜µè®¡ç®—ã€ç¬¦å·è¿ç®—ã€æ–¹ç¨‹æ±‚è§£ç­‰
- **ğŸ“¦ é›¶ä¾èµ–**: æ— éœ€é¢å¤–é…ç½®ï¼Œä¸€é”®éƒ¨ç½²å³å¯ä½¿ç”¨
- **ğŸ”’ ç±»å‹å®‰å…¨**: å®Œæ•´çš„ TypeScript æ”¯æŒå’Œç±»å‹å®šä¹‰

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### åŸºç¡€æ•°å­¦è¿ç®—
- âœ… å››åˆ™è¿ç®—ï¼ˆåŠ å‡ä¹˜é™¤ï¼‰
- âœ… å¹‚è¿ç®—å’Œå¼€æ–¹
- âœ… ä¸‰è§’å‡½æ•°ï¼ˆsin/cos/tanï¼‰
- âœ… å¯¹æ•°å’ŒæŒ‡æ•°å‡½æ•°
- âœ… æ•°å­¦å¸¸é‡ï¼ˆÏ€ã€eï¼‰

### é«˜çº§æ•°å­¦åŠŸèƒ½
- âœ… çŸ©é˜µè¿ç®—ï¼ˆåˆ›å»ºã€åŠ æ³•ã€ä¹˜æ³•ï¼‰
- âœ… ç¬¦å·è®¡ç®—å’Œè¡¨è¾¾å¼è§£æ
- âœ… æ±‚å¯¼æ•°è®¡ç®—
- âœ… è¡¨è¾¾å¼ç®€åŒ–å’Œæœ‰ç†åŒ–
- âœ… çº¿æ€§æ–¹ç¨‹ç»„æ±‚è§£

### MCP å·¥å…·åˆ—è¡¨

| å·¥å…·åç§° | åŠŸèƒ½æè¿° | ç¤ºä¾‹ |
|---------|----------|------|
| `evaluateMath` | è§£æå¹¶è®¡ç®—æ•°å­¦è¡¨è¾¾å¼ | `sin(pi/2) + cos(0)` |
| `calculateSimple` | ç®€å•æ•°å­¦è¡¨è¾¾å¼è®¡ç®— | `2+3*4` |
| `calculateAdvanced` | é«˜çº§å››åˆ™è¿ç®— | æ”¯æŒåŠ å‡ä¹˜é™¤æ“ä½œ |
| `createMatrix` | åˆ›å»ºçŸ©é˜µ | `[[1,2],[3,4]]` |
| `matrixAdd` | çŸ©é˜µåŠ æ³• | ä¸¤ä¸ªçŸ©é˜µç›¸åŠ  |
| `matrixMultiply` | çŸ©é˜µä¹˜æ³• | ä¸¤ä¸ªçŸ©é˜µç›¸ä¹˜ |
| `symbolicCompute` | ç¬¦å·è®¡ç®— | è¡¨è¾¾å¼è§£æä¸ºç¬¦å·æ ‘ |
| `derivative` | æ±‚å¯¼æ•° | `d/dx(x^2)` |
| `rationalize` | è¡¨è¾¾å¼æœ‰ç†åŒ– | åˆ†å¼åŒ–ç®€ |
| `solveLinearSystem` | çº¿æ€§æ–¹ç¨‹ç»„æ±‚è§£ | Ax=b å½¢å¼æ±‚è§£ |

## ğŸŒ åœ¨çº¿ä½“éªŒ

- **SSE æ¥å£**: https://math.sereniblue.com/sse
- **MCP æ¥å£**: https://math.sereniblue.com/mcp

## ğŸ“– ä½¿ç”¨ç¤ºä¾‹

### åŸºç¡€æ•°å­¦è¿ç®—
```json
{
  "tool": "evaluateMath",
  "arguments": {
    "expression": "sin(pi/2) + sqrt(16)"
  }
}
// è¿”å›: 5
```

### çŸ©é˜µè¿ç®—
```json
{
  "tool": "matrixMultiply",
  "arguments": {
    "a": [[1, 2], [3, 4]],
    "b": [[5, 6], [7, 8]]
  }
}
// è¿”å›: [[19, 22], [43, 50]]
```

### æ±‚å¯¼è®¡ç®—
```json
{
  "tool": "derivative",
  "arguments": {
    "expr": "x^2 + 3*x + 2",
    "variable": "x"
  }
}
// è¿”å›: 2*x + 3
```

### çº¿æ€§æ–¹ç¨‹ç»„æ±‚è§£
```json
{
  "tool": "solveLinearSystem",
  "arguments": {
    "coefficients": [[2, 1], [1, 3]],
    "constants": [4, 7]
  }
}
// æ±‚è§£: 2x + y = 4, x + 3y = 7
// è¿”å›: [1, 2]
```

## ğŸ› ï¸ å¿«é€Ÿéƒ¨ç½²

### å‰ç½®è¦æ±‚
- Node.js 18+
- Cloudflare è´¦æˆ·
- Wrangler CLI

### éƒ¨ç½²æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
```bash
git clone <your-repo-url>
cd math-mcp-cloudflare
```

2. **å®‰è£…ä¾èµ–**
```bash
pnpm install
```

3. **é…ç½®åŸŸå**
ç¼–è¾‘ `wrangler.jsonc` æ–‡ä»¶ï¼Œä¿®æ”¹è‡ªå®šä¹‰åŸŸåï¼š
```json
{
  "routes": [{
    "pattern": "your-domain.com",
    "custom_domain": true
  }]
}
```

4. **éƒ¨ç½²åˆ° Cloudflare**
```bash
pnpm run deploy
```

### æœ¬åœ°å¼€å‘
```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
pnpm run dev

# è¿è¡Œæµ‹è¯•
pnpm run test

# ç±»å‹æ£€æŸ¥
pnpm run type-check

# ä»£ç æ ¼å¼åŒ–
pnpm run format
```

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æ ¸å¿ƒæŠ€æœ¯æ ˆ
- **è¿è¡Œç¯å¢ƒ**: Cloudflare Workers
- **å¼€å‘è¯­è¨€**: TypeScript
- **Web æ¡†æ¶**: Hono
- **MCP åè®®**: @modelcontextprotocol/sdk
- **æ•°å­¦åº“**: mathjs
- **æ„å»ºå·¥å…·**: Wrangler
- **æµ‹è¯•æ¡†æ¶**: Vitest
- **ä»£ç è´¨é‡**: Biome

### é¡¹ç›®ç»“æ„
```
math-mcp-cloudflare/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.ts          # åº”ç”¨å…¥å£ï¼Œè·¯ç”±é…ç½®
â”‚   â”œâ”€â”€ mcp.ts            # MCP æœåŠ¡å®ç°
â”‚   â”œâ”€â”€ tools.ts          # æ•°å­¦è¿ç®—å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ stdio.ts          # æ ‡å‡†è¾“å…¥è¾“å‡ºå¤„ç†
â”œâ”€â”€ tests/
â”‚   â””â”€â”€ æ•°å­¦è¿ç®—å·¥å…·.test.ts # æµ‹è¯•ç”¨ä¾‹
â”œâ”€â”€ .trae/
â”‚   â””â”€â”€ documents/
â”‚       â””â”€â”€ æ•°å­¦è¿ç®—å·¥å…·äº§å“æ–‡æ¡£.md # äº§å“æ–‡æ¡£
â”œâ”€â”€ wrangler.jsonc        # Cloudflare Worker é…ç½®
â”œâ”€â”€ package.json          # é¡¹ç›®ä¾èµ–å’Œè„šæœ¬
â””â”€â”€ README.md            # é¡¹ç›®è¯´æ˜æ–‡æ¡£
```

### å“åº”æ ¼å¼
æ‰€æœ‰å·¥å…·å‡½æ•°éƒ½è¿”å›ç»Ÿä¸€çš„å“åº”æ ¼å¼ï¼š
```typescript
interface ToolResponse<T = any> {
  state: boolean;    // æ‰§è¡ŒçŠ¶æ€ï¼štrue=æˆåŠŸï¼Œfalse=å¤±è´¥
  message: string;   // çŠ¶æ€æ¶ˆæ¯
  data: T | null;    // è¿”å›æ•°æ®ï¼Œå¤±è´¥æ—¶ä¸ºnull
}
```

## ğŸ“š API æ–‡æ¡£

### æ¥å£ç«¯ç‚¹
- **SSE æ¥å£**: `https://your-domain.com/sse`
- **MCP æ¥å£**: `https://your-domain.com/mcp`

### å·¥å…·è°ƒç”¨æ ¼å¼
```json
{
  "method": "tools/call",
  "params": {
    "name": "å·¥å…·åç§°",
    "arguments": {
      "å‚æ•°å": "å‚æ•°å€¼"
    }
  }
}
```

### é”™è¯¯å¤„ç†
å½“å·¥å…·è°ƒç”¨å¤±è´¥æ—¶ï¼Œè¿”å›æ ¼å¼å¦‚ä¸‹ï¼š
```json
{
  "state": false,
  "message": "é”™è¯¯æè¿°ä¿¡æ¯",
  "data": null
}
```

## ğŸ§ª æµ‹è¯•

é¡¹ç›®åŒ…å«å®Œæ•´çš„æµ‹è¯•ç”¨ä¾‹ï¼Œè¦†ç›–æ‰€æœ‰æ•°å­¦è¿ç®—åŠŸèƒ½ï¼š

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pnpm run test

# è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
pnpm run test:run
```

### æµ‹è¯•è¦†ç›–èŒƒå›´
- âœ… åŸºç¡€æ•°å­¦è¡¨è¾¾å¼è®¡ç®—
- âœ… ä¸‰è§’å‡½æ•°å’Œé«˜çº§æ•°å­¦å‡½æ•°
- âœ… çŸ©é˜µè¿ç®—ï¼ˆåˆ›å»ºã€åŠ æ³•ã€ä¹˜æ³•ï¼‰
- âœ… ç¬¦å·è®¡ç®—å’Œè¡¨è¾¾å¼ç®€åŒ–
- âœ… æ±‚å¯¼æ•°è®¡ç®—
- âœ… è¡¨è¾¾å¼æœ‰ç†åŒ–
- âœ… çº¿æ€§æ–¹ç¨‹ç»„æ±‚è§£
- âœ… é”™è¯¯å¤„ç†æœºåˆ¶

## ğŸ”§ é…ç½®è¯´æ˜

### Wrangler é…ç½®
`wrangler.jsonc` æ–‡ä»¶åŒ…å« Cloudflare Worker çš„éƒ¨ç½²é…ç½®ï¼š

```json
{
  "name": "math-mcp-cloudflare",
  "main": "src/index.ts",
  "compatibility_date": "2025-03-10",
  "compatibility_flags": ["nodejs_compat"],
  "routes": [{
    "pattern": "your-domain.com",
    "custom_domain": true
  }]
}
```

### ç¯å¢ƒå˜é‡
é¡¹ç›®æ— éœ€é¢å¤–çš„ç¯å¢ƒå˜é‡é…ç½®ï¼Œå¼€ç®±å³ç”¨ã€‚

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ä»£ç ï¼è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/æ–°åŠŸèƒ½`)
3. æäº¤æ›´æ”¹ (`git commit -am 'æ·»åŠ æ–°åŠŸèƒ½'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/æ–°åŠŸèƒ½`)
5. åˆ›å»º Pull Request

### ä»£ç è§„èŒƒ
- ä½¿ç”¨ TypeScript è¿›è¡Œå¼€å‘
- éµå¾ª Biome ä»£ç æ ¼å¼è§„èŒƒ
- ä¸ºæ–°åŠŸèƒ½æ·»åŠ ç›¸åº”çš„æµ‹è¯•ç”¨ä¾‹
- æ›´æ–°ç›¸å…³æ–‡æ¡£

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™‹â€â™‚ï¸ å¸¸è§é—®é¢˜

### Q: å¦‚ä½•æ·»åŠ æ–°çš„æ•°å­¦è¿ç®—åŠŸèƒ½ï¼Ÿ
A: åœ¨ `src/tools.ts` ä¸­æ·»åŠ æ–°çš„å·¥å…·å‡½æ•°ï¼Œç„¶ååœ¨ `src/mcp.ts` ä¸­æ³¨å†Œå¯¹åº”çš„ MCP å·¥å…·ã€‚

### Q: æ”¯æŒå“ªäº›æ•°å­¦å‡½æ•°ï¼Ÿ
A: æ”¯æŒ mathjs åº“æä¾›çš„æ‰€æœ‰æ•°å­¦å‡½æ•°ï¼ŒåŒ…æ‹¬åŸºç¡€è¿ç®—ã€ä¸‰è§’å‡½æ•°ã€å¯¹æ•°ã€çŸ©é˜µè¿ç®—ç­‰ã€‚

### Q: å¦‚ä½•å¤„ç†å¤æ‚çš„æ•°å­¦è¡¨è¾¾å¼ï¼Ÿ
A: ä½¿ç”¨ `evaluateMath` å·¥å…·ï¼Œæ”¯æŒå¤æ‚çš„æ•°å­¦è¡¨è¾¾å¼è§£æå’Œè®¡ç®—ã€‚

### Q: æ˜¯å¦æ”¯æŒè‡ªå®šä¹‰å˜é‡ï¼Ÿ
A: æ˜¯çš„ï¼Œ`evaluateMathExpression` å‡½æ•°æ”¯æŒä¼ å…¥å˜é‡ä½œç”¨åŸŸå¯¹è±¡ã€‚

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š
- æäº¤ Issue
- å‘èµ· Pull Request
- é‚®ç®±è”ç³»ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰

---

â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ª Star æ”¯æŒä¸€ä¸‹ï¼